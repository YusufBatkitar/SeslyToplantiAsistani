<!doctype html>
<html lang="tr">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SESLY • Login</title>

  <!-- Font (istersen kaldırıp system font kullanabilirsin) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- Supabase JS -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Poppins", system-ui, -apple-system, "Segoe UI", sans-serif;
      min-height: 100vh;
      color: #eaf0ff;
      background:
        radial-gradient(900px 600px at 20% 10%, rgba(154, 91, 255, 0.22), transparent 60%),
        radial-gradient(900px 600px at 85% 25%, rgba(77, 167, 255, 0.18), transparent 55%),
        radial-gradient(900px 600px at 40% 95%, rgba(255, 79, 182, 0.16), transparent 60%),
        #060816;
      display: grid;
      place-items: center;
      padding: 24px;
    }

    .wrap {
      width: min(980px, 100%);
      display: grid;
      grid-template-columns: 1.1fr 0.9fr;
      gap: 18px;
      align-items: stretch;
    }

    .brand {
      border: 1px solid rgba(255, 255, 255, 0.10);
      border-radius: 22px;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.07), rgba(255, 255, 255, 0.03));
      backdrop-filter: blur(10px);
      overflow: hidden;
      padding: 28px;
      position: relative;
      min-height: 520px;
    }

    .brand::before {
      content: "";
      position: absolute;
      inset: -140px -180px auto auto;
      width: 520px;
      height: 520px;
      background: radial-gradient(circle, rgba(255, 79, 182, 0.22), rgba(154, 91, 255, 0.16), transparent 65%);
      filter: blur(10px);
      pointer-events: none;
    }

    .brand-top {
      display: flex;
      align-items: center;
      gap: 14px;
      position: relative;
      z-index: 1;
    }

    .logo-img {
      width: 80px;
      height: 80px;
      object-fit: contain;
      filter: drop-shadow(0 12px 24px rgba(0, 0, 0, 0.35));
    }

    .wordmark {
      font-size: 28px;
      font-weight: 600;
      letter-spacing: 0.16em;
      background: linear-gradient(90deg, #FF4FB6 0%, #9A5BFF 45%, #4DA7FF 100%);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      color: transparent;
      line-height: 1;
    }

    .brand h1 {
      margin-top: 26px;
      font-size: 34px;
      line-height: 1.08;
      letter-spacing: -0.02em;
      position: relative;
      z-index: 1;
    }

    .brand p {
      margin-top: 14px;
      color: rgba(234, 240, 255, 0.75);
      font-size: 14px;
      line-height: 1.6;
      position: relative;
      z-index: 1;
      max-width: 52ch;
    }

    .chips {
      margin-top: 18px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      position: relative;
      z-index: 1;
    }

    .chip {
      font-size: 12px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.10);
      background: rgba(255, 255, 255, 0.05);
      color: rgba(234, 240, 255, 0.85);
    }

    .card {
      border: 1px solid rgba(255, 255, 255, 0.10);
      border-radius: 22px;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.07), rgba(255, 255, 255, 0.03));
      backdrop-filter: blur(10px);
      padding: 22px;
      min-height: 520px;
    }

    .tabs {
      display: flex;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 14px;
      padding: 6px;
      gap: 6px;
    }

    .tab {
      flex: 1;
      border: 0;
      background: transparent;
      color: rgba(234, 240, 255, 0.75);
      padding: 10px 12px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      transition: .2s ease;
    }

    .tab.active {
      background: linear-gradient(90deg, rgba(154, 91, 255, 0.26), rgba(77, 167, 255, 0.10));
      color: #fff;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
    }

    form {
      margin-top: 16px;
      display: grid;
      gap: 12px;
    }

    label {
      font-size: 12px;
      color: rgba(234, 240, 255, 0.75);
    }

    .field {
      display: grid;
      gap: 6px;
    }

    input {
      width: 100%;
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid rgba(255, 255, 255, 0.10);
      background: rgba(255, 255, 255, 0.06);
      color: #fff;
      outline: none;
      transition: .2s ease;
    }

    input:focus {
      border-color: rgba(154, 91, 255, 0.55);
      box-shadow: 0 0 0 3px rgba(154, 91, 255, 0.18);
    }

    .row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    .hint {
      font-size: 12px;
      color: rgba(234, 240, 255, 0.65);
    }

    .btn {
      width: 100%;
      border: 0;
      cursor: pointer;
      padding: 12px 14px;
      border-radius: 14px;
      font-weight: 700;
      transition: .2s ease;
    }

    .btn-primary {
      background: linear-gradient(90deg, #FF4FB6 0%, #9A5BFF 45%, #4DA7FF 100%);
      color: #0b1020;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      filter: brightness(1.03);
    }

    .btn-ghost {
      margin-top: 10px;
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid rgba(255, 255, 255, 0.10);
      color: #fff;
    }

    .btn-ghost:hover {
      background: rgba(255, 255, 255, 0.09);
    }

    .msg {
      margin-top: 12px;
      font-size: 12px;
      color: rgba(234, 240, 255, 0.75);
      min-height: 18px;
    }

    .msg.ok {
      color: #86efac;
    }

    .msg.err {
      color: #fda4af;
    }

    @media (max-width: 920px) {
      .wrap {
        grid-template-columns: 1fr;
      }

      .brand,
      .card {
        min-height: unset;
      }
    }
  </style>
</head>

<body>
  <div class="wrap">

    <section class="brand">
      <div class="brand-top">
        <img class="logo-img" src="/sesly_logo/seslylogo.png" alt="SESLY logo">
        <div class="wordmark">SESLY</div>
      </div>

      <h1>Toplantılarını tek yerden yönet.<br />Özet, kayıt, takip.</h1>
      <p>
        SESLY ile Zoom / Teams / Meet toplantılarını listele, toplantı özetlerine eriş,
        transkript durumunu takip et. Giriş yapıp devam et.
      </p>

      <div class="chips">
        <div class="chip">Dashboard</div>
        <div class="chip">Toplantılar</div>
        <div class="chip">Takvim</div>
        <div class="chip">Özet & Transkript</div>
      </div>
    </section>

    <section class="card">
      <div class="tabs">
        <button class="tab active" id="tabLogin" type="button">Giriş</button>
        <button class="tab" id="tabSignup" type="button">Kayıt Ol</button>
      </div>

      <!-- LOGIN -->
      <form id="loginForm">
        <div class="field">
          <label for="loginEmail">E-posta</label>
          <input id="loginEmail" type="email" placeholder="ornek@mail.com" required>
        </div>

        <div class="field">
          <label for="loginPass">Şifre</label>
          <input id="loginPass" type="password" placeholder="••••••••" required>
        </div>

        <div class="row">
          <span class="hint">Giriş başarılı olunca yönlendireceğiz.</span>
        </div>

        <button class="btn btn-primary" type="submit">Giriş Yap</button>
        <button class="btn btn-ghost" id="btnLogout" type="button" style="display:none;">Çıkış Yap</button>

        <div class="msg" id="msgLogin"></div>
      </form>

      <!-- SIGNUP -->
      <form id="signupForm" style="display:none;">
        <div class="field">
          <label for="signupEmail">E-posta</label>
          <input id="signupEmail" type="email" placeholder="ornek@mail.com" required>
        </div>

        <div class="field">
          <label for="signupPass">Şifre</label>
          <input id="signupPass" type="password" placeholder="En az 6 karakter" minlength="6" required>
        </div>

        <button class="btn btn-primary" type="submit">Hesap Oluştur</button>

        <div class="msg" id="msgSignup"></div>
      </form>
    </section>

  </div>

  <script>
    // -- UI LOGIC (TABS) --
    // Supabase hatası olsa bile sekmeler çalışsın diye en başa aldık.
    const tabLogin = document.getElementById("tabLogin");
    const tabSignup = document.getElementById("tabSignup");
    const loginForm = document.getElementById("loginForm");
    const signupForm = document.getElementById("signupForm");
    const msgLogin = document.getElementById("msgLogin");
    const msgSignup = document.getElementById("msgSignup");

    function setMsg(el, text, type) {
      el.className = "msg" + (type ? " " + type : "");
      el.textContent = text || "";
    }
    function clearMsgs() {
      setMsg(msgLogin, "");
      setMsg(msgSignup, "");
    }

    if (tabLogin && tabSignup && loginForm && signupForm) {
      tabLogin.onclick = () => {
        tabLogin.classList.add("active");
        tabSignup.classList.remove("active");
        loginForm.style.display = "";
        signupForm.style.display = "none";
        clearMsgs();
      };
      tabSignup.onclick = () => {
        tabSignup.classList.add("active");
        tabLogin.classList.remove("active");
        signupForm.style.display = "";
        loginForm.style.display = "none";
        clearMsgs();
      };
    }

    // -- BACKEND LOGIC (SUPABASE) --
    // ✅ Buraya Supabase bilgilerini koy
    const SUPABASE_URL = "{{ SUPABASE_URL }}";
    const SUPABASE_ANON_KEY = "{{ SUPABASE_ANON_KEY }}";

    let supabaseClient = null;

    try {
      if (typeof supabase !== 'undefined') {
        supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
      } else {
        console.warn("Supabase library not loaded.");
      }
    } catch (err) {
      console.error("Supabase init error:", err);
    }

    // Login Handler
    loginForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      setMsg(msgLogin, "Giriş yapılıyor...");

      // Supabase yoksa demo login
      if (!supabaseClient) {
        // Demo simülasyonu
        setTimeout(() => {
          setMsg(msgLogin, "Demo modu: Giriş başarılı! Yönlendiriliyorsun...", "ok");
          setTimeout(() => window.location.href = "/admin", 1000);
        }, 800);
        return;
      }

      const email = document.getElementById("loginEmail").value.trim();
      const password = document.getElementById("loginPass").value;

      const { data, error } = await supabaseClient.auth.signInWithPassword({ email, password });
      if (error) return setMsg(msgLogin, error.message, "err");

      setMsg(msgLogin, "Giriş başarılı! Yönlendiriliyorsun...", "ok");
      setTimeout(() => window.location.href = "/admin", 600);
    });

    // Signup Handler
    signupForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      setMsg(msgSignup, "Hesap oluşturuluyor...");

      if (!supabaseClient) {
        setMsg(msgSignup, "Demo modu: Kayıt özelliği pasif (Supabase ayarlı değil).", "err");
        return;
      }

      const email = document.getElementById("signupEmail").value.trim();
      const password = document.getElementById("signupPass").value;

      const { data, error } = await supabaseClient.auth.signUp({ email, password });
      if (error) return setMsg(msgSignup, error.message, "err");

      setMsg(msgSignup, "Kayıt başarılı! E-posta doğrulaması gerekebilir. Sonra giriş yap.", "ok");
    });

    // (Opsiyonel) sayfa açılınca session var mı?
    (async () => {
      if (!supabaseClient) return;

      const { data } = await supabaseClient.auth.getSession();
      const btnLogout = document.getElementById("btnLogout");

      if (data && data.session) {
        if (btnLogout) btnLogout.style.display = "";
        setMsg(msgLogin, "Zaten giriş yapılmış. Devam edebilirsin.", "ok");
      }
    })();

    // Logout
    const btnLogout = document.getElementById("btnLogout");
    if (btnLogout) {
      btnLogout.addEventListener("click", async () => {
        if (supabaseClient) await supabaseClient.auth.signOut();
        location.reload();
      });
    }
  </script>
</body>

</html>